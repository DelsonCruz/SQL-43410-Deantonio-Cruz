

DROP DATABASE IF EXISTS `KARDEX_DB`;
CREATE DATABASE `KARDEX_DB`;
USE `KARDEX_DB`;

CREATE TABLE KARDEX_IMPORTADO(
ARTICULO TEXT,
FECHA_ADQUISICION TEXT,
PRECIO TEXT
);

-- CARGAR tabla importada --

LOAD DATA INFILE 'C:/Program Files/MySQL/KARDEX/KARDEX_UNO.csv'
INTO TABLE KARDEX_IMPORTADO
FIELDS TERMINATED BY ',' -- Indica el delimitador de campos del CSV (en este caso, una coma)
ENCLOSED BY '"' -- Indica el carácter de comillas utilizado en el CSV (opcional)
LINES TERMINATED BY '\n' -- Indica el delimitador de líneas del CSV (en este caso, un salto de línea)
IGNORE 1 ROWS; -- Ignora la primera línea del archivo (opcional si la primera línea contiene nombres de columnas)	


-- traer tabla importada --
CREATE TABLE KARDEX_DB(
`columna1` TEXT, `columna2` DATE, `columna3` INT
);
SELECT 'columna1', 'columna2', 'columna3'
FROM KARDEX_IMPORTADO;



-- CREATE OR REPLACE VIEW --VISTA1 

CREATE VIEW KARDEX_DB AS
SELECT 'columna1'
FROM KARDEX_IMPORTADO
WHERE CAMA = 'columna1';


-- SELECT - Columnas específicas de la tabla --VISTA2
CREATE OR REPLACE VIEW vista_productos_vendidos AS
SELECT producto_id, nombre, cantidad_vendida
FROM ventas
WHERE fecha > '2023-01-01';

-- SELECT - Condiciones --VISTA3
CREATE OR REPLACE VIEW vista_clientes_activos AS
SELECT cliente_id, nombre, direccion
FROM clientes
WHERE estado = 'activo';

-- SELECT - Ordenar los resultados --VISTA4
CREATE OR REPLACE VIEW vista_pedidos_pendientes AS
SELECT pedido_id, fecha_pedido, estado
FROM pedidos
WHERE estado = 'pendiente';

-- SELECT - Limitar la cantidad de registros mostrados --VISTA5
CREATE OR REPLACE VIEW vista_ingresos_diarios AS
SELECT fecha, SUM(total) AS ingresos
FROM ventas
GROUP BY fecha;

